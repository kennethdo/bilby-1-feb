{
  "project": "Ralph Test App",
  "description": "Express.js REST API with JWT authentication and user management",
  "stories": [
    {
      "id": "RTA-001",
      "title": "Database setup with users table",
      "description": "Create src/db.js that initializes a SQLite database using better-sqlite3. Create a users table with id (integer primary key autoincrement), email (text unique not null), password_hash (text not null), created_at (text default current_timestamp). Export the db instance and a function to initialize the database.",
      "acceptance_criteria": [
        "src/db.js exports a configured better-sqlite3 instance",
        "Users table is created on initialization with correct schema",
        "Database file is created at data/app.db",
        "data/ directory is created if it doesn't exist",
        "Tests pass"
      ],
      "priority": 1,
      "passes": true
    },
    {
      "id": "RTA-002",
      "title": "User registration endpoint",
      "description": "Create POST /api/auth/register endpoint in src/routes/auth.js. Accept JSON body with email and password. Hash the password with bcryptjs, insert into users table, return 201 with { id, email }. Return 400 if email already exists or fields are missing.",
      "acceptance_criteria": [
        "POST /api/auth/register creates a new user",
        "Password is hashed with bcryptjs before storing",
        "Returns 201 with user id and email (no password)",
        "Returns 400 if email already taken",
        "Returns 400 if email or password missing",
        "Tests pass"
      ],
      "priority": 2,
      "passes": true
    },
    {
      "id": "RTA-003",
      "title": "User login endpoint with JWT",
      "description": "Create POST /api/auth/login endpoint in src/routes/auth.js. Accept JSON body with email and password. Verify credentials against database, return 200 with { token } (JWT signed with a secret from environment or hardcoded default). Return 401 if credentials are wrong.",
      "acceptance_criteria": [
        "POST /api/auth/login returns a valid JWT token",
        "JWT contains user id and email in payload",
        "Returns 401 for wrong email or password",
        "Returns 400 if email or password missing",
        "Tests pass"
      ],
      "priority": 3,
      "passes": false
    },
    {
      "id": "RTA-004",
      "title": "Auth middleware for protected routes",
      "description": "Create src/middleware/auth.js that exports a middleware function. It reads the Authorization header (Bearer <token>), verifies the JWT, and attaches the decoded user to req.user. Returns 401 if token is missing or invalid.",
      "acceptance_criteria": [
        "Middleware extracts Bearer token from Authorization header",
        "Valid token attaches decoded payload to req.user",
        "Missing token returns 401 with error message",
        "Invalid/expired token returns 401 with error message",
        "Tests pass"
      ],
      "priority": 4,
      "passes": false
    },
    {
      "id": "RTA-005",
      "title": "Protected GET /api/me endpoint",
      "description": "Create GET /api/me endpoint in src/routes/auth.js that uses the auth middleware. Returns the current user's id, email, and created_at from the database. This proves the full auth flow works end-to-end.",
      "acceptance_criteria": [
        "GET /api/me returns current user data when authenticated",
        "Returns 401 when no token provided",
        "Returns 401 when invalid token provided",
        "Response includes id, email, and created_at",
        "Tests pass"
      ],
      "priority": 5,
      "passes": false
    },
    {
      "id": "RTA-006",
      "title": "App entry point wiring everything together",
      "description": "Create src/index.js that initializes Express, parses JSON bodies, mounts auth routes at /api/auth and the /api/me route, initializes the database, and listens on PORT from env or 3000. Export the app for testing.",
      "acceptance_criteria": [
        "src/index.js creates and configures Express app",
        "JSON body parsing enabled",
        "Auth routes mounted at correct paths",
        "Database initialized on startup",
        "Server listens on configurable port",
        "App is exported for test usage",
        "Tests pass"
      ],
      "priority": 6,
      "passes": false
    }
  ]
}
